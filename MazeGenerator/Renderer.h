#pragma once
#include <GLFW/glfw3.h>
#include <iostream>
#include <string>
#include "utils.cpp"
#include <vector>
#include <memory>
#include "Segment.h"
#include "Player.h"

class Renderer {
private:
	GLFWwindow* window;	
	int screenWidth;
	int screenHeight;
	std::string windowTitle;

	Rect mazeDrawingSquare;
	Rect projectionDrawingSquare;

	//RGB wallTexture[16][16] = { {RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{198,104,81},RGB{124,69,54},RGB{124,69,54},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{155,86,67},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125}},{RGB{177,98,77},RGB{155,86,67},RGB{115,63,49},RGB{139,110,103},RGB{198,104,81},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{155,86,67},RGB{143,80,63},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{155,86,67},RGB{139,110,103},RGB{155,86,67},RGB{143,80,63},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{139,110,103},RGB{162,134,125},RGB{169,148,141},RGB{169,148,141},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{162,134,125},RGB{162,134,125},RGB{162,134,125},RGB{169,148,141},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{198,104,81},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125},RGB{155,86,67},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{198,104,81},RGB{143,80,63},RGB{124,69,54},RGB{162,134,125},RGB{155,86,67},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{198,104,81},RGB{143,80,63},RGB{115,63,49},RGB{139,110,103},RGB{177,98,77},RGB{143,80,63},RGB{124,69,54},RGB{162,134,125},RGB{198,104,81},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{198,104,81},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{155,86,67},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125},RGB{198,104,81},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{155,86,67},RGB{143,80,63},RGB{115,63,49},RGB{162,134,125}},{RGB{177,98,77},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{162,134,125},RGB{162,134,125},RGB{169,148,141},RGB{169,148,141},RGB{177,98,77},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{139,110,103},RGB{162,134,125},RGB{169,148,141},RGB{169,148,141}},{RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{198,104,81},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125},RGB{155,86,67},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{198,104,81},RGB{143,80,63},RGB{115,63,49},RGB{162,134,125}},{RGB{177,98,77},RGB{155,86,67},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{143,80,63},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{162,134,125}},{RGB{155,86,67},RGB{143,80,63},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{143,80,63},RGB{124,69,54},RGB{139,110,103},RGB{155,86,67},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{162,134,125},RGB{162,134,125},RGB{162,134,125},RGB{169,148,141},RGB{177,98,77},RGB{143,80,63},RGB{143,80,63},RGB{139,110,103},RGB{162,134,125},RGB{162,134,125},RGB{169,148,141},RGB{169,148,141},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{198,104,81},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125},RGB{155,86,67},RGB{143,80,63},RGB{143,80,63},RGB{139,110,103},RGB{198,104,81},RGB{143,80,63},RGB{124,69,54},RGB{162,134,125},RGB{155,86,67},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103}},{RGB{177,98,77},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{177,98,77},RGB{143,80,63},RGB{124,69,54},RGB{139,110,103},RGB{198,104,81},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{162,134,125}},{RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{155,86,67},RGB{124,69,54},RGB{115,63,49},RGB{162,134,125},RGB{177,98,77},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{155,86,67},RGB{124,69,54},RGB{115,63,49},RGB{169,148,141}},{RGB{177,98,77},RGB{155,86,67},RGB{124,69,54},RGB{139,110,103},RGB{139,110,103},RGB{162,134,125},RGB{162,134,125},RGB{169,148,141},RGB{177,98,77},RGB{155,86,67},RGB{143,80,63},RGB{139,110,103},RGB{162,134,125},RGB{162,134,125},RGB{169,148,141},RGB{169,148,141}} };
	//RGB wallTexture[16][16] = { {RGB{45,45,45},RGB{45,45,45},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{88,88,88},RGB{75,76,79},RGB{65,65,65},RGB{36,36,36},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{36,36,36},RGB{56,55,55},RGB{65,65,65}},{RGB{36,36,36},RGB{65,65,65},RGB{45,45,45},RGB{36,36,36},RGB{45,45,45},RGB{36,36,36},RGB{88,88,88},RGB{75,76,79},RGB{75,76,79},RGB{45,45,45},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{65,65,65},RGB{45,45,45}},{RGB{36,36,36},RGB{56,55,55},RGB{45,45,45},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{75,76,79},RGB{65,65,65},RGB{75,76,79},RGB{45,45,45},RGB{56,55,55},RGB{45,45,45},RGB{45,45,45},RGB{36,36,36},RGB{45,45,45},RGB{65,65,65}},{RGB{36,36,36},RGB{36,36,36},RGB{36,36,36},RGB{36,36,36},RGB{36,36,36},RGB{36,36,36},RGB{88,88,88},RGB{75,76,79},RGB{65,65,65},RGB{36,36,36},RGB{45,45,45},RGB{36,36,36},RGB{45,45,45},RGB{36,36,36},RGB{65,65,65},RGB{56,55,55}},{RGB{45,45,45},RGB{88,88,88},RGB{88,88,88},RGB{75,76,79},RGB{45,45,45},RGB{36,36,36},RGB{75,76,79},RGB{65,65,65},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{36,36,36},RGB{45,45,45},RGB{65,65,65},RGB{56,55,55}},{RGB{45,45,45},RGB{88,88,88},RGB{75,76,79},RGB{75,76,79},RGB{56,55,55},RGB{45,45,45},RGB{65,65,65},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{75,76,79},RGB{75,76,79},RGB{65,65,65},RGB{45,45,45},RGB{65,65,65},RGB{56,55,55}},{RGB{36,36,36},RGB{75,76,79},RGB{75,76,79},RGB{75,76,79},RGB{65,65,65},RGB{45,45,45},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{45,45,45},RGB{88,88,88},RGB{65,65,65},RGB{65,65,65},RGB{45,45,45},RGB{56,55,55},RGB{45,45,45}},{RGB{36,36,36},RGB{88,88,88},RGB{75,76,79},RGB{65,65,65},RGB{65,65,65},RGB{36,36,36},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{45,45,45},RGB{88,88,88},RGB{65,65,65},RGB{65,65,65},RGB{36,36,36},RGB{45,45,45},RGB{45,45,45}},{RGB{36,36,36},RGB{88,88,88},RGB{65,65,65},RGB{75,76,79},RGB{56,55,55},RGB{36,36,36},RGB{36,36,36},RGB{45,45,45},RGB{45,45,45},RGB{36,36,36},RGB{75,76,79},RGB{65,65,65},RGB{65,65,65},RGB{45,45,45},RGB{56,55,55},RGB{36,36,36}},{RGB{45,45,45},RGB{88,88,88},RGB{65,65,65},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{56,55,55},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{88,88,88},RGB{65,65,65},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{45,45,45}},{RGB{36,36,36},RGB{65,65,65},RGB{45,45,45},RGB{65,65,65},RGB{56,55,55},RGB{45,45,45},RGB{56,55,55},RGB{45,45,45},RGB{56,55,55},RGB{45,45,45},RGB{65,65,65},RGB{45,45,45},RGB{56,55,55},RGB{36,36,36},RGB{45,45,45},RGB{56,55,55}},{RGB{36,36,36},RGB{36,36,36},RGB{65,65,65},RGB{65,65,65},RGB{56,55,55},RGB{36,36,36},RGB{45,45,45},RGB{45,45,45},RGB{56,55,55},RGB{45,45,45},RGB{88,88,88},RGB{65,65,65},RGB{36,36,36},RGB{36,36,36},RGB{56,55,55},RGB{56,55,55}},{RGB{36,36,36},RGB{56,55,55},RGB{65,65,65},RGB{65,65,65},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{45,45,45},RGB{36,36,36},RGB{75,76,79},RGB{65,65,65},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{45,45,45}},{RGB{45,45,45},RGB{75,76,79},RGB{56,55,55},RGB{65,65,65},RGB{56,55,55},RGB{36,36,36},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{65,65,65},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{65,65,65},RGB{65,65,65}},{RGB{45,45,45},RGB{65,65,65},RGB{56,55,55},RGB{56,55,55},RGB{56,55,55},RGB{36,36,36},RGB{56,55,55},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{65,65,65},RGB{56,55,55},RGB{45,45,45},RGB{36,36,36},RGB{65,65,65},RGB{56,55,55}},{RGB{36,36,36},RGB{45,45,45},RGB{45,45,45},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{45,45,45},RGB{45,45,45},RGB{36,36,36},RGB{36,36,36},RGB{56,55,55},RGB{45,45,45},RGB{45,45,45},RGB{36,36,36},RGB{56,55,55},RGB{56,55,55}} };
	RGB wallTexture[16][16] = { {RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35},RGB{51,47,22},RGB{64,60,35},RGB{64,60,35},RGB{64,60,35},RGB{116,112,87},RGB{51,47,22},RGB{51,47,22},RGB{51,47,22},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62}},{RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{76,72,47},RGB{76,72,47},RGB{51,47,22},RGB{51,47,22},RGB{51,47,22},RGB{43,39,14},RGB{43,39,14},RGB{43,39,14},RGB{51,47,22},RGB{149,145,120},RGB{116,112,87},RGB{91,87,62}},{RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{43,39,14},RGB{43,39,14},RGB{43,39,14},RGB{51,47,22},RGB{51,47,22},RGB{91,87,62},RGB{64,60,35},RGB{51,47,22},RGB{116,112,87},RGB{149,145,120},RGB{91,87,62}},{RGB{64,60,35},RGB{91,87,62},RGB{149,145,120},RGB{91,87,62},RGB{76,72,47},RGB{64,60,35},RGB{116,112,87},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{116,112,87},RGB{91,87,62},RGB{76,72,47},RGB{64,60,35},RGB{116,112,87},RGB{76,72,47}},{RGB{51,47,22},RGB{116,112,87},RGB{116,112,87},RGB{76,72,47},RGB{64,60,35},RGB{116,112,87},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{149,145,120},RGB{116,112,87},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35}},{RGB{64,60,35},RGB{149,145,120},RGB{91,87,62},RGB{76,72,47},RGB{64,60,35},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{149,145,120},RGB{76,72,47},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35}},{RGB{64,60,35},RGB{116,112,87},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{149,145,120},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{76,72,47}},{RGB{43,39,14},RGB{51,47,22},RGB{116,112,87},RGB{76,72,47},RGB{51,47,22},RGB{149,145,120},RGB{116,112,87},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{91,87,62},RGB{116,112,87},RGB{76,72,47},RGB{64,60,35},RGB{43,39,14}},{RGB{64,60,35},RGB{64,60,35},RGB{91,87,62},RGB{76,72,47},RGB{43,39,14},RGB{51,47,22},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35},RGB{51,47,22},RGB{43,39,14},RGB{43,39,14},RGB{64,60,35}},{RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{51,47,22},RGB{51,47,22},RGB{43,39,14},RGB{116,112,87},RGB{91,87,62},RGB{76,72,47},RGB{116,112,87},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35},RGB{64,60,35},RGB{64,60,35},RGB{116,112,87}},{RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{116,112,87},RGB{76,72,47},RGB{64,60,35},RGB{43,39,14},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35},RGB{149,145,120}},{RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{91,87,62},RGB{116,112,87},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{149,145,120}},{RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{149,145,120},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{149,145,120}},{RGB{51,47,22},RGB{64,60,35},RGB{64,60,35},RGB{149,145,120},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35}},{RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{116,112,87},RGB{76,72,47},RGB{64,60,35},RGB{76,72,47},RGB{64,60,35},RGB{116,112,87},RGB{91,87,62},RGB{91,87,62},RGB{91,87,62},RGB{76,72,47},RGB{116,112,87},RGB{91,87,62},RGB{91,87,62}},{RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{76,72,47},RGB{64,60,35},RGB{64,60,35},RGB{116,112,87},RGB{91,87,62},RGB{76,72,47},RGB{91,87,62},RGB{76,72,47},RGB{149,145,120},RGB{91,87,62},RGB{91,87,62}} };

	float scaleX(int x);
	float scaleY(int y);
	float map(float value, float istart, float istop, float ostart, float ostop);
public:
	Renderer(Size mazeRealSize, std::string windowTitle, Rect mazeDrawingSquare, Rect projectionDrawingSquare);
	~Renderer();

	void init();

	Coordinates getMousePosition();
	void setMousePosition(Coordinates position);

	bool isKeyPressed(int key);
	bool leftClick();
	bool closing();

	void update();

	void drawPixel(int x, int y);
	void drawPixel(int x, int y, RGB color);
	void drawPixel(Coordinates p);
	void drawPixel(Coordinates p, RGB color);

	void drawLine(int x1, int y1, int x2, int y2);
	void drawLine(int x1, int y1, int x2, int y2, RGB color);
	void drawLine(Coordinates p1, Coordinates p2);
	void drawLine(Coordinates p1, Coordinates p2, RGB color);
	void drawLine(Line l);
	void drawLine(Line l, RGB color);
	
	void drawLines(std::vector<Line> lines);
	void drawLines(std::vector<Line> lines, RGB color);
	
	void drawSegment(std::shared_ptr<Segment> segment);
	void drawSegments(std::vector<std::shared_ptr<Segment>> segments);
	void drawSegment(std::shared_ptr<Segment> segment, RGB color);
	void drawSegments(std::vector<std::shared_ptr<Segment>> segments, RGB color);

	void drawView(std::vector<std::shared_ptr<Segment>> r, bool connect = true);
	void drawView(std::vector<std::shared_ptr<Segment>> r, RGB color, bool connect = true);

	void drawRect(Coordinates topLeft, Coordinates size);
	void drawRect(Coordinates topLeft, Coordinates size, RGB color);
	void drawRect(Rect rect);
	void drawRect(Rect rect, RGB color);

	void drawProjection(std::vector<RenderInfo> distances, float wallHeight=8000);
};